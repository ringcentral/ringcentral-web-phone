{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./demo/index.js","webpack:///external {\"commonjs\":\"ringcentral-web-phone\",\"commonjs2\":\"ringcentral-web-phone\",\"amd\":\"ringcentral-web-phone\",\"root\":[\"RingCentral\",\"WebPhone\"]}"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","1","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","SIP","$","jQuery","SDK","WebPhone","RingCentral","sdk","platform","webPhone","logLevel","username","extension","$app","$loginTemplate","$authFlowTemplate","$callTemplate","$incomingTemplate","$acceptedTemplate","remoteVideoElement","document","getElementById","localVideoElement","outboundCall","confSessionId","cloneTemplate","$tpl","html","postLogin","server","appKey","appSecret","login","ext","password","ll","localStorage","setItem","then","res","json","console","log","post","sipInfo","transport","register","makeCallForm","catch","e","error","stack","getItem","audioHelper","enabled","parseInt","appName","appVersion","media","remote","local","enableQos","enableMediaReportLogging","userAgent","loadAudio","incoming","outgoing","setVolume","on","onInvite","arguments","reconnect","session","request","to","displayName","friendlyName","from","headers","raw","accept","onAccepted","$modal","modal","backdrop","find","css","reject","toVoicemail","preventDefault","stopPropagation","forward","val","trim","replyWithMessage","replyType","replyText","activeCallInfoTemplate","id","direction","sipData","toTag","fromTag","$info","eq","$dtmf","$transfer","$flip","interval","setInterval","time","startTime","Math","round","Date","now","text","JSON","stringify","close","clearInterval","ua","volume","mute","unmute","hold","unhold","startRecord","stopRecord","park","transfer","newSession","invite","once","warmTransfer","flip","dtmf","onConference","response","pId","activeCalls","partyId","tId","telephonySessionId","voiceCallToken","getConfVoiceToken","voiceToken","number","fromNumber","url","bringIn","startConferenceCall","terminate","activeCallInfo","uri","user","dialog","callId","remoteTag","localTag","captureActiveCallInfo","$form","$authForm","$server","$appKey","$appSecret","$login","$ext","$password","$logLevel","$number","$homeCountry","$username","$logout","$switch","contact","firstName","lastName","company","unregister","location","reload","activeCallItem","parse","switchFrom","homeCountryId","regionalSettings","homeCountry","empty","append","sandbox","match","replace","$redirectUri","decodeURIComponent","href","split","redirectUri","loginUrl","loginWindow","show3LeggedLogin","undefined"],"mappings":"aACA,SAAAA,EAAAC,GAQA,IAPA,IAMAC,EAAAC,EANAC,EAAAH,EAAA,GACAI,EAAAJ,EAAA,GACAK,EAAAL,EAAA,GAIAM,EAAA,EAAAC,EAAA,GACQD,EAAAH,EAAAK,OAAoBF,IAC5BJ,EAAAC,EAAAG,GACAG,EAAAP,IACAK,EAAAG,KAAAD,EAAAP,GAAA,IAEAO,EAAAP,GAAA,EAEA,IAAAD,KAAAG,EACAO,OAAAC,UAAAC,eAAAC,KAAAV,EAAAH,KACAc,EAAAd,GAAAG,EAAAH,IAKA,IAFAe,KAAAhB,GAEAO,EAAAC,QACAD,EAAAU,OAAAV,GAOA,OAHAW,EAAAR,KAAAS,MAAAD,EAAAb,GAAA,IAGAe,IAEA,SAAAA,IAEA,IADA,IAAAC,EACAf,EAAA,EAAiBA,EAAAY,EAAAV,OAA4BF,IAAA,CAG7C,IAFA,IAAAgB,EAAAJ,EAAAZ,GACAiB,GAAA,EACAC,EAAA,EAAkBA,EAAAF,EAAAd,OAA2BgB,IAAA,CAC7C,IAAAC,EAAAH,EAAAE,GACA,IAAAf,EAAAgB,KAAAF,GAAA,GAEAA,IACAL,EAAAQ,OAAApB,IAAA,GACAe,EAAAM,IAAAC,EAAAN,EAAA,KAIA,OAAAD,EAIA,IAAAQ,EAAA,GAKApB,EAAA,CACAqB,EAAA,GAGAZ,EAAA,GAGA,SAAAS,EAAA1B,GAGA,GAAA4B,EAAA5B,GACA,OAAA4B,EAAA5B,GAAA8B,QAGA,IAAAC,EAAAH,EAAA5B,GAAA,CACAK,EAAAL,EACAgC,GAAA,EACAF,QAAA,IAUA,OANAhB,EAAAd,GAAAa,KAAAkB,EAAAD,QAAAC,IAAAD,QAAAJ,GAGAK,EAAAC,GAAA,EAGAD,EAAAD,QAKAJ,EAAAO,EAAAnB,EAGAY,EAAAQ,EAAAN,EAGAF,EAAAS,EAAA,SAAAL,EAAAM,EAAAC,GACAX,EAAAY,EAAAR,EAAAM,IACA1B,OAAA6B,eAAAT,EAAAM,EAAA,CAA0CI,YAAA,EAAAC,IAAAJ,KAK1CX,EAAAgB,EAAA,SAAAZ,GACA,oBAAAa,eAAAC,aACAlC,OAAA6B,eAAAT,EAAAa,OAAAC,YAAA,CAAwDC,MAAA,WAExDnC,OAAA6B,eAAAT,EAAA,cAAiDe,OAAA,KAQjDnB,EAAAoB,EAAA,SAAAD,EAAAE,GAEA,GADA,EAAAA,IAAAF,EAAAnB,EAAAmB,IACA,EAAAE,EAAA,OAAAF,EACA,KAAAE,GAAA,iBAAAF,QAAAG,WAAA,OAAAH,EACA,IAAAI,EAAAvC,OAAAwC,OAAA,MAGA,GAFAxB,EAAAgB,EAAAO,GACAvC,OAAA6B,eAAAU,EAAA,WAAyCT,YAAA,EAAAK,UACzC,EAAAE,GAAA,iBAAAF,EAAA,QAAAM,KAAAN,EAAAnB,EAAAS,EAAAc,EAAAE,EAAA,SAAAA,GAAgH,OAAAN,EAAAM,IAAqBC,KAAA,KAAAD,IACrI,OAAAF,GAIAvB,EAAA2B,EAAA,SAAAtB,GACA,IAAAM,EAAAN,KAAAiB,WACA,WAA2B,OAAAjB,EAAA,SAC3B,WAAiC,OAAAA,GAEjC,OADAL,EAAAS,EAAAE,EAAA,IAAAA,GACAA,GAIAX,EAAAY,EAAA,SAAAgB,EAAAC,GAAsD,OAAA7C,OAAAC,UAAAC,eAAAC,KAAAyC,EAAAC,IAGtD7B,EAAA8B,EAAA,GAEA,IAAAC,EAAAC,OAAA,aAAAA,OAAA,iBACAC,EAAAF,EAAAhD,KAAA2C,KAAAK,GACAA,EAAAhD,KAAAX,EACA2D,IAAAG,QACA,QAAAvD,EAAA,EAAgBA,EAAAoD,EAAAlD,OAAuBF,IAAAP,EAAA2D,EAAApD,IACvC,IAAAU,EAAA4C,EAIA1C,EAAAR,KAAA,QAEAU,yBCvJA,MAAA0C,EAAYnC,EAAQ,IACpBoC,EAAUpC,EAAQ,IAElBgC,OAAAK,OAAAD,EACAJ,OAAAG,MAEAC,EAAA,WACsBpC,EAAQ,IAA9B,MACAsC,EAAgBtC,EAAQ,IACxBuC,EAAqBvC,EAAQ,KAAuBgC,OAAAQ,YAAAD,SAGpD,IAAAE,EAAA,KACAC,EAAA,KAEAC,EAAA,KAEAC,EAAA,EACAC,EAAA,KACAC,EAAA,KAEAC,EAAAX,EAAA,QAEAY,EAAAZ,EAAA,mBACAa,EAAAb,EAAA,uBACAc,EAAAd,EAAA,kBACAe,EAAAf,EAAA,sBACAgB,EAAAhB,EAAA,sBAEAiB,EAAAC,SAAAC,eAAA,eACAC,EAAAF,SAAAC,eAAA,cAEAE,GAAA,EACAC,EAAA,GAMA,SAAAC,EAAAC,GACA,OAAAxB,EAAAwB,EAAAC,QA4DA,SAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,GAYA,OAXAzB,EAAAyB,EACAxB,EAAAqB,EAEAI,aAAAC,QAAA,iBAAAR,GAAA,IACAO,aAAAC,QAAA,iBAAAP,GAAA,IACAM,aAAAC,QAAA,oBAAAN,GAAA,IACAK,aAAAC,QAAA,gBAAAL,GAAA,IACAI,aAAAC,QAAA,oBAAAJ,GAAA,IACAG,aAAAC,QAAA,mBAAAH,GAAA,IACAE,aAAAC,QAAA,mBAAA3B,GAAA,GAEAF,EACA3B,IAAA,uCACAyD,KAAA,SAAAC,GAKA,OAJA3B,EAAA2B,EAAAC,OAEAC,QAAAC,IAAA,iBAAA9B,GAEAJ,EAAAmC,KAAA,8BACAC,QAAA,CACA,CACAC,UAAA,YAKAP,KAAA,SAAAC,GACA,OAAAA,EAAAC,SAEAF,KAAAQ,GACAR,KAAAS,GACAC,MAAA,SAAAC,GACAR,QAAAS,MAAA,+BACAT,QAAAS,MAAAD,EAAAE,OAAAF,KAIA,SAAAH,EAAA3G,GAgEA,OA/DAA,EAAAyG,QAAA,IAAAzG,EAAAyG,SAEAnC,EAAA,IAAAJ,EAAAlE,EAAA,CACA2F,OAAAM,aAAAgB,QAAA,kBACAC,YAAA,CACAC,SAAA,GAEA5C,SAAA6C,SAAA7C,EAAA,IACA8C,QAAA,eACAC,WAAA,QACAC,MAAA,CACAC,OAAAxC,EACAyC,MAAAtC,GAEAuC,WAAA,EACAC,0BAAA,KAOAC,UAAAV,YAAAW,UAAA,CACAC,SAAA,qBACAC,SAAA,uBAGAzD,EAAAsD,UAAAV,YAAAc,UAAA,IACA1D,EAAAsD,UAAAK,GAAA,SAAAC,GACA5D,EAAAsD,UAAAK,GAAA,wBACA3B,QAAAC,IAAA,mBAEAjC,EAAAsD,UAAAK,GAAA,uBACA3B,QAAAC,IAAA,kBAEAjC,EAAAsD,UAAAK,GAAA,0BACA3B,QAAAC,IAAA,qBAEAjC,EAAAsD,UAAAK,GAAA,wBACA3B,QAAAC,IAAA,mBAEAjC,EAAAsD,UAAAK,GAAA,0BACA3B,QAAAC,IAAA,qBAEAjC,EAAAsD,UAAAK,GAAA,gCACA3B,QAAAC,IAAA,wBAAA4B,aAEA7D,EAAAsD,UAAAK,GAAA,qBACA3B,QAAAC,IAAA,aAAA4B,aAEA7D,EAAAsD,UAAAlB,UAAAuB,GAAA,6BACA3B,QAAAC,IAAA,4CACAjC,EAAAsD,UAAAlB,UAAA0B,WAAA,KAEA9D,EAAAsD,UAAAlB,UAAAuB,GAAA,oBACA3B,QAAAC,IAAA,uBAEAjC,EAAAsD,UAAAlB,UAAAuB,GAAA,4BACA3B,QAAAC,IAAA,sCAEAjC,EAAAsD,UAAAlB,UAAAuB,GAAA,+BACA3B,QAAAC,IAAA,yCAEAjC,EAGA,SAAA4D,EAAAG,GAMA,GALAjD,GAAA,EACAkB,QAAAC,IAAA,gBAAA8B,EAAAC,SACAhC,QAAAC,IAAA,KAAA8B,EAAAC,QAAAC,GAAAC,YAAAH,EAAAC,QAAAC,GAAAE,cACAnC,QAAAC,IAAA,OAAA8B,EAAAC,QAAAI,KAAAF,YAAAH,EAAAC,QAAAI,KAAAD,cAEAJ,EAAAC,QAAAK,QAAA,+BAAAN,EAAAC,QAAAK,QAAA,iBAAAC,IACAP,EACAQ,SACA1C,KAAA,WACA2C,EAAAT,KAEAxB,MAAA,SAAAC,GACAR,QAAAS,MAAA,gBAAAD,EAAAE,OAAAF,SAES,CACT,IAAAiC,EAAAzD,EAAAR,GAAAkE,MAAA,CACAC,SAAA,WAGAF,EAAAG,KAAA,WAAAjB,GAAA,mBACAc,EAAAG,KAAA,kBAAAC,IAAA,kBACAJ,EAAAG,KAAA,aAAAC,IAAA,cACAd,EACAQ,SACA1C,KAAA,WACA4C,EAAAC,MAAA,QACAF,EAAAT,KAEAxB,MAAA,SAAAC,GACAR,QAAAS,MAAA,gBAAAD,EAAAE,OAAAF,OAIAiC,EAAAG,KAAA,YAAAjB,GAAA,mBACAI,EAAAe,WAGAL,EAAAG,KAAA,gBAAAjB,GAAA,mBACAI,EAAAgB,gBAGAN,EAAAG,KAAA,iBAAAjB,GAAA,kBAAAnB,GACAA,EAAAwC,iBACAxC,EAAAyC,kBACAlB,EACAmB,QACAT,EACAG,KAAA,uBACAO,MACAC,QAEAvD,KAAA,WACAG,QAAAC,IAAA,aACAwC,EAAAC,MAAA,UAEAnC,MAAA,SAAAC,GACAR,QAAAS,MAAA,iBAAAD,EAAAE,OAAAF,OAIAiC,EAAAG,KAAA,eAAAjB,GAAA,kBAAAnB,GACAA,EAAAwC,iBACAxC,EAAAyC,kBACAlB,EACAsB,iBAAA,CACAC,UAAA,EACAC,UAAAd,EAAAG,KAAA,qBAAAO,QAEAtD,KAAA,WACAG,QAAAC,IAAA,WACAwC,EAAAC,MAAA,UAEAnC,MAAA,SAAAC,GACAR,QAAAS,MAAA,eAAAD,EAAAE,OAAAF,OAIAuB,EAAAJ,GAAA,sBACAc,EAAAC,MAAA,WAKA,MAAAc,EAAA,MACAC,GAAA,GACArB,KAAA,GACAH,GAAA,GACAyB,UAAA,GACAC,QAAA,CACAC,MAAA,GACAC,QAAA,MAkBA,SAAArB,EAAAT,GACA/B,QAAAC,IAAA,kBAAA8B,EAAAC,SACAhC,QAAAC,IAAA,KAAA8B,EAAAC,QAAAC,GAAAC,YAAAH,EAAAC,QAAAC,GAAAE,cACAnC,QAAAC,IAAA,OAAA8B,EAAAC,QAAAI,KAAAF,YAAAH,EAAAC,QAAAI,KAAAD,cAEA,IAAAM,EAAAzD,EAAAP,GAAAiE,QAEAoB,EAAArB,EAAAG,KAAA,SAAAmB,GAAA,GACAC,EAAAvB,EAAAG,KAAA,oBAAAmB,GAAA,GACAE,EAAAxB,EAAAG,KAAA,wBAAAmB,GAAA,GACAG,EAAAzB,EAAAG,KAAA,oBAAAmB,GAAA,GAGAI,GAFA1B,EAAAG,KAAA,0BAAAmB,GAAA,GAEAK,YAAA,WACA,IAAAC,EAAAtC,EAAAuC,UAAAC,KAAAC,OAAAC,KAAAC,MAAA3C,EAAAuC,WAAA,mBAEAR,EAAAa,KAAA,SAAAN,EAAA,gBAAAO,KAAAC,UAAA9C,EAAAuC,UAAA,eACS,MAET,SAAAQ,IACAC,cAAAZ,GACA1B,EAAAC,MAAA,QAGAD,EAAAG,KAAA,oBAAAjB,GAAA,mBACAI,EAAAiD,GAAApE,YAAAc,WACA,OAAAK,EAAAiD,GAAApE,YAAAqE,OAAAlD,EAAAiD,GAAApE,YAAAqE,OAAA,UAIAxC,EAAAG,KAAA,oBAAAjB,GAAA,mBACAI,EAAAiD,GAAApE,YAAAc,WACA,OAAAK,EAAAiD,GAAApE,YAAAqE,OAAAlD,EAAAiD,GAAApE,YAAAqE,OAAA,UAIAxC,EAAAG,KAAA,SAAAjB,GAAA,mBACAI,EAAAmD,SAGAzC,EAAAG,KAAA,WAAAjB,GAAA,mBACAI,EAAAoD,WAGA1C,EAAAG,KAAA,SAAAjB,GAAA,mBACAI,EACAqD,OACAvF,KAAA,WACAG,QAAAC,IAAA,aAEAM,MAAA,SAAAC,GACAR,QAAAS,MAAA,iBAAAD,EAAAE,OAAAF,OAIAiC,EAAAG,KAAA,WAAAjB,GAAA,mBACAI,EACAsD,SACAxF,KAAA,WACAG,QAAAC,IAAA,eAEAM,MAAA,SAAAC,GACAR,QAAAS,MAAA,mBAAAD,EAAAE,OAAAF,OAGAiC,EAAAG,KAAA,gBAAAjB,GAAA,mBACAI,EACAuD,cACAzF,KAAA,WACAG,QAAAC,IAAA,uBAEAM,MAAA,SAAAC,GACAR,QAAAS,MAAA,yBAAAD,EAAAE,OAAAF,OAIAiC,EAAAG,KAAA,eAAAjB,GAAA,mBACAI,EACAwD,aACA1F,KAAA,WACAG,QAAAC,IAAA,uBAEAM,MAAA,SAAAC,GACAR,QAAAS,MAAA,wBAAAD,EAAAE,OAAAF,OAIAiC,EAAAG,KAAA,SAAAjB,GAAA,mBACAI,EACAyD,OACA3F,KAAA,WACAG,QAAAC,IAAA,YAEAM,MAAA,SAAAC,GACAR,QAAAS,MAAA,cAAAD,EAAAE,OAAAF,OAIAiC,EAAAG,KAAA,kBAAAjB,GAAA,kBAAAnB,GACAA,EAAAwC,iBACAxC,EAAAyC,kBACAlB,EACA0D,SAAAxB,EAAAd,MAAAC,QACAvD,KAAA,WACAG,QAAAC,IAAA,iBAEAM,MAAA,SAAAC,GACAR,QAAAS,MAAA,kBAAAD,EAAAE,OAAAF,OAIAiC,EAAAG,KAAA,8BAAAjB,GAAA,iBAAAnB,GACAA,EAAAwC,iBACAxC,EAAAyC,kBACAlB,EAAAqD,OAAAvF,KAAA,WACAG,QAAAC,IAAA,0DACA,IAAAyF,EAAA3D,EAAAiD,GAAAW,OAAA1B,EAAAd,MAAAC,QACAsC,EAAAE,KAAA,sBACA5F,QAAAC,IAAA,8DACAwC,EAAAG,KAAA,kCAAAjB,GAAA,iBAAAnB,GACAuB,EACA8D,aAAAH,GACA7F,KAAA,WACAG,QAAAC,IAAA,6BAEAM,MAAA,SAAAC,GACAR,QAAAS,MAAA,kBAAAD,EAAAE,OAAAF,aAOAiC,EAAAG,KAAA,cAAAjB,GAAA,kBAAAnB,GACAA,EAAAwC,iBACAxC,EAAAyC,kBACAlB,EACA+D,KAAA5B,EAAAf,MAAAC,QACAvD,KAAA,WACAG,QAAAC,IAAA,aAEAM,MAAA,SAAAC,GACAR,QAAAS,MAAA,cAAAD,EAAAE,OAAAF,KAEA0D,EAAAf,IAAA,MAGAV,EAAAG,KAAA,cAAAjB,GAAA,kBAAAnB,GACAA,EAAAwC,iBACAxC,EAAAyC,kBACAlB,EAAAgE,KAAA/B,EAAAb,MAAAC,QACAY,EAAAb,IAAA,MAGAV,EAAAG,KAAA,cAEAjB,GAAA,iBAAAnB,GAuFAwF,GAcAjI,EAAA3B,IAAA,4EAbAyD,KAAAC,IACA,IAAAmG,EAAAnG,EAAAC,OACAmG,EAAAD,EAAAE,YAAA,GAAAC,QACAC,EAAAJ,EAAAE,YAAA,GAAAG,oBAaA,SAAAJ,EAAAG,GACA,OAAAtI,EAAAmC,KAAA,mDAA+EL,KAAAC,IAC/Ef,EAAAe,EAAAC,OAAAgC,QAAA0B,GACA3D,EAAAC,OAAAgC,QAAAwE,kBAfAC,GAAA3G,KAAA4G,KAmBA,SAAAC,EAAAR,EAAAG,GACA,IAAAtE,EAAA/D,EAAAsD,UAAAqE,OAAAe,EAAA,CACAC,WAAAzI,IAEA6D,EAAAJ,GAAA,sBACAa,EAAAT,GACA/B,QAAAC,IAAA,2BAWA,SAAAoG,EAAAH,GACA,IAAAU,EAAA,sDAAA7H,EAAA,oBACA,OAAAhB,EAAAmC,KAAA0G,EAAA,CACAN,mBAAAD,EACAD,QAAAF,IAdAW,CAAAR,EAAAH,GACArG,KAAAoG,IACAjG,QAAAC,IAAA,sCAAAgG,EAAAlG,UAEAQ,MAAA,SAAAC,GACAR,QAAAS,MAAA,yBAAAD,EAAAE,OAAAF,OA9BAsG,CAAAL,EAAAP,EAAAG,GACAL,GAAA,QA1FAvD,EAAAG,KAAA,WAAAjB,GAAA,mBACAI,EAAAgF,cAGAhF,EAAAJ,GAAA,sBACA3B,QAAAC,IAAA,mBAnLA,SAAA8B,GACA,MAAA2B,EAAA5E,EAAA,qBACA,IAAAkI,EAAAxD,IACAwD,EAAA5E,KAAAL,EAAAC,QAAAI,KAAA6E,IAAAC,KACAF,EAAA/E,GAAAF,EAAAC,QAAAC,GAAAgF,IAAAC,KACAF,EAAAtD,YACAsD,EAAAvD,GAAA1B,EAAAoF,OAAA1D,GAAA2D,OACAJ,EAAArD,QAAAE,QAAA9B,EAAAoF,OAAA1D,GAAA4D,UACAL,EAAArD,QAAAC,MAAA7B,EAAAoF,OAAA1D,GAAA6D,SACA3H,aAAAgB,QAAA,mBACAhB,aAAAC,QAAA,iBAAAgF,KAAAC,UAAAmC,IA0KAO,CAAAxF,KAEAA,EAAAJ,GAAA,sBACA3B,QAAAC,IAAA,qBAEA8B,EAAAJ,GAAA,sBACA3B,QAAAC,IAAA,mBACA6E,MAEA/C,EAAAJ,GAAA,oBACA3B,QAAAC,IAAA,gBAAA4B,WACAiD,MAEA/C,EAAAJ,GAAA,wBACA3B,QAAAC,IAAA,qBACAN,aAAAC,QAAA,qBACAkF,MAEA/C,EAAAJ,GAAA,oBACA3B,QAAAC,IAAA,iBACA6E,MAEA/C,EAAAJ,GAAA,mBACA3B,QAAAC,IAAA,gBACA6E,MAEA/C,EAAAJ,GAAA,oBAAA+D,GACA1F,QAAAC,IAAA,+BAAA8B,EAAA,yBAAA2D,GACAZ,IACAtC,EAAAkD,KAEA3D,EAAAJ,GAAA,kBACA3B,QAAAC,IAAA,iBAEA8B,EAAAJ,GAAA,mBACA3B,QAAAC,IAAA,kBAEA8B,EAAAJ,GAAA,qBACA3B,QAAAC,IAAA,oBAEA8B,EAAAJ,GAAA,wBACA3B,QAAAC,IAAA,uBAEA8B,EAAAJ,GAAA,iBACA3B,QAAAC,IAAA,cACA6E,MA6BA,IAsGA0C,EACAC,EAEAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EA/GAhC,GAAA,EAoDA,SAAA1F,IACA,IAAAkH,EAAAxI,EAAAT,GAEA0J,EAAAT,EAAA5E,KAAA,sBAAAmB,GAAA,GACAmE,EAAAV,EAAA5E,KAAA,2BAAAmB,GAAA,GACAoE,EAAAX,EAAA5E,KAAA,aAAAmB,GAAA,GACAqE,EAAAZ,EAAA5E,KAAA,WAAAmB,GAAA,GACAsE,EAAAb,EAAA5E,KAAA,WAAAmB,GAAA,GAEAoE,EAAAjJ,KACA,2BAEAf,EAAAmK,QAAAC,UACA,IACApK,EAAAmK,QAAAE,SACA,6BAEArK,EAAAmK,QAAAG,SAAA,KACA,iCAEAvK,EACA,cAIAkK,EAAAzG,GAAA,iBAAAnB,GACAxC,EAAAsD,UAAAoH,aACAlI,EAAAwC,iBACA2F,SAAAC,WAGAP,EAAA1G,GAAA,iBAAAnB,GA1FA,IACAqI,IAAAjE,KAAAkE,MAAAnJ,aAAAgB,QAAA,mBACAX,QAAAC,IAAA,yCAAA4I,GAEArG,EADAxE,EAAAsD,UAAAyH,WAAAF,MA2FAZ,EAAA9E,IAAAxD,aAAAgB,QAAA,2BAEA6G,EAAA7F,GAAA,kBAAAnB,GAlHA,IAAAkG,EAAAsC,EAmHAxI,EAAAwC,iBACAxC,EAAAyC,kBAEAtD,aAAAC,QAAA,qBAAAqI,EAAA9E,OAAA,IAtHAuD,EAwHAuB,EAAA9E,MAxHA6F,EAwHAd,EAAA/E,MAvHArE,GAAA,EACAkK,EACAA,GACA7K,GACAA,EAAA8K,kBACA9K,EAAA8K,iBAAAC,aACA/K,EAAA8K,iBAAAC,YAAAzF,IACA,KAOAjB,EALAxE,EAAAsD,UAAAqE,OAAAe,EAAA,CACAC,WAAAzI,EACA8K,qBA+GA5K,EAAA+K,QAAAC,OAAA5B,GAIAA,EAAAxI,EAAAX,GACAoJ,EAAAzI,EAAAV,GAEAoJ,EAAAD,EAAA7E,KAAA,sBAAAmB,GAAA,GACA4D,EAAAF,EAAA7E,KAAA,sBAAAmB,GAAA,GACA6D,EAAAH,EAAA7E,KAAA,yBAAAmB,GAAA,GACA8D,EAAAL,EAAA5E,KAAA,qBAAAmB,GAAA,GACA+D,EAAAN,EAAA5E,KAAA,yBAAAmB,GAAA,GACAgE,EAAAP,EAAA5E,KAAA,wBAAAmB,GAAA,GACAiE,EAAAP,EAAA7E,KAAA,yBAAAmB,GAAA,GAEA2D,EAAAvE,IAAAxD,aAAAgB,QAAA,mBAAAhD,EAAAyB,OAAAiK,SACA1B,EAAAxE,IAAAxD,aAAAgB,QAAA,uBACAiH,EAAAzE,IAAAxD,aAAAgB,QAAA,0BACAkH,EAAA1E,IAAAxD,aAAAgB,QAAA,sBACAmH,EAAA3E,IAAAxD,aAAAgB,QAAA,0BACAoH,EAAA5E,IAAAxD,aAAAgB,QAAA,yBACAqH,EAAA7E,IAAAxD,aAAAgB,QAAA,qBAAA1C,GAEAuJ,EAAA7F,GAAA,kBAAAnB,GACAR,QAAAC,IAAA,eAEAO,EAAAwC,iBACAxC,EAAAyC,kBA5nBA,SAAA7D,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,GACA5B,EAAA,IAAAH,EAAA,CACA0B,SACAC,YACAF,WAGArB,EAAAD,EAAAC,WAGAwB,IAEAA,GADAA,IAAA+J,MAAA,SAAA/J,EAAA,IAAAA,GACAgK,QAAA,WAGAxL,EACAwB,MAAA,CACArB,SAAAqB,EACApB,UAAAqB,GAAA,KACAC,aAEAI,KAAA,WACA,OAAAV,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,KAEAa,MAAA,SAAAC,GACAR,QAAAS,MAAAD,EAAAE,OAAAF,KAqmBAjB,CACAmI,EAAAvE,MACAwE,EAAAxE,MACAyE,EAAAzE,MACA0E,EAAA1E,MACA2E,EAAA3E,MACA4E,EAAA5E,MACA6E,EAAA7E,SAIAsE,EAAA9F,GAAA,kBAAAnB,GACAR,QAAAC,IAAA,mBAEAO,EAAAwC,iBACAxC,EAAAyC,kBA/mBA,SAAA7D,EAAAC,EAAAC,EAAAI,GACA,IAAA8J,EAAAC,mBAAApM,OAAAsL,SAAAe,KAAAC,MAAA,4BAEA3J,QAAAC,IAAA,2BAAAuJ,GAEA1L,EAAA,IAAAH,EAAA,CACA0B,SACAC,YACAF,SACAwK,YAAAJ,IAKA,IAAAK,GAFA9L,EAAAD,EAAAC,YAEA8L,WAEA9L,EACA+L,YAAA,CAA0BlD,IAAAiD,IAC1BhK,KAAA9B,EAAAwB,MAAAxC,KAAAgB,IACA8B,KAAA,WACA,OAAAV,EAAAC,EAAAC,EAAAC,EAAA,SAAAI,KAEAa,MAAA,SAAAC,GACAR,QAAAS,MAAAD,EAAAE,OAAAF,KA0lBAuJ,CAAArC,EAAAvE,MAAAwE,EAAAxE,MAAAyE,EAAAzE,MAAA6E,EAAA7E,SAGA/E,EAAA+K,QACAC,OAAA3B,GACA2B,OAAA5B,uBC/rBA9L,EAAAD,aAAAuO","file":"demo.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t1: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([37,0]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","const SIP = require('sip.js');\nconst $ = require('jquery');\n\nwindow.jQuery = $;\nwindow.SIP = SIP;\n\n$(function() {\n    const bootstrap = require('bootstrap');\n    const SDK = require('ringcentral');\n    const WebPhone = require('ringcentral-web-phone') || window.RingCentral.WebPhone;\n\n    /** @type {SDK} */\n    var sdk = null;\n    var platform = null;\n    /** @type {WebPhone} */\n    var webPhone = null;\n\n    var logLevel = 0;\n    var username = null;\n    var extension = null;\n    var sipInfo = null;\n    var $app = $('#app');\n\n    var $loginTemplate = $('#template-login');\n    var $authFlowTemplate = $('#template-auth-flow');\n    var $callTemplate = $('#template-call');\n    var $incomingTemplate = $('#template-incoming');\n    var $acceptedTemplate = $('#template-accepted');\n\n    var remoteVideoElement = document.getElementById('remoteVideo');\n    var localVideoElement = document.getElementById('localVideo');\n    var activeCallInfo = '';\n    var outboundCall = true;\n    var confSessionId = '';\n\n    /**\n     * @param {jQuery|HTMLElement} $tpl\n     * @return {jQuery|HTMLElement}\n     */\n    function cloneTemplate($tpl) {\n        return $($tpl.html());\n    }\n\n    function login(server, appKey, appSecret, login, ext, password, ll) {\n        sdk = new SDK({\n            appKey,\n            appSecret,\n            server\n        });\n\n        platform = sdk.platform();\n\n        // TODO: Improve later to support international phone number country codes better\n        if (login) {\n            login = login.match(/^[+1]/) ? login : '1' + login;\n            login = login.replace(/\\W/g, '');\n        }\n\n        platform\n            .login({\n                username: login,\n                extension: ext || null,\n                password\n            })\n            .then(function() {\n                return postLogin(server, appKey, appSecret, login, ext, password, ll);\n            })\n            .catch(function(e) {\n                console.error(e.stack || e);\n            });\n    }\n\n    // Redirect function\n    function show3LeggedLogin(server, appKey, appSecret, ll) {\n        var $redirectUri = decodeURIComponent(window.location.href.split('login', 1) + 'callback.html');\n\n        console.log('The redirect uri value :', $redirectUri);\n\n        sdk = new SDK({\n            appKey,\n            appSecret,\n            server,\n            redirectUri: $redirectUri\n        });\n\n        platform = sdk.platform();\n\n        var loginUrl = platform.loginUrl();\n\n        platform\n            .loginWindow({url: loginUrl}) // this method also allows to supply more options to control window position\n            .then(platform.login.bind(platform))\n            .then(function() {\n                return postLogin(server, appKey, appSecret, '', '', '', ll);\n            })\n            .catch(function(e) {\n                console.error(e.stack || e);\n            });\n    }\n\n    function postLogin(server, appKey, appSecret, login, ext, password, ll) {\n        logLevel = ll;\n        username = login;\n\n        localStorage.setItem('webPhoneServer', server || '');\n        localStorage.setItem('webPhoneAppKey', appKey || '');\n        localStorage.setItem('webPhoneAppSecret', appSecret || '');\n        localStorage.setItem('webPhoneLogin', login || '');\n        localStorage.setItem('webPhoneExtension', ext || '');\n        localStorage.setItem('webPhonePassword', password || '');\n        localStorage.setItem('webPhoneLogLevel', logLevel || 0);\n\n        return platform\n            .get('/restapi/v1.0/account/~/extension/~')\n            .then(function(res) {\n                extension = res.json();\n\n                console.log('Extension info', extension);\n\n                return platform.post('/client-info/sip-provision', {\n                    sipInfo: [\n                        {\n                            transport: 'WSS'\n                        }\n                    ]\n                });\n            })\n            .then(function(res) {\n                return res.json();\n            })\n            .then(register)\n            .then(makeCallForm)\n            .catch(function(e) {\n                console.error('Error in main promise chain');\n                console.error(e.stack || e);\n            });\n    }\n\n    function register(data) {\n        sipInfo = data.sipInfo[0] || data.sipInfo;\n\n        webPhone = new WebPhone(data, {\n            appKey: localStorage.getItem('webPhoneAppKey'),\n            audioHelper: {\n                enabled: true\n            },\n            logLevel: parseInt(logLevel, 10),\n            appName: 'WebPhoneDemo',\n            appVersion: '1.0.0',\n            media: {\n                remote: remoteVideoElement,\n                local: localVideoElement\n            },\n            enableQos: true,\n            enableMediaReportLogging: true\n            // enableTurnServers: true or false,\n            // turnServers: [{urls:'turn:192.168.0.1', username : 'turn' , credential: 'turn'}],\n            // iceTransportPolicy: \"all\" or \"relay\",\n            // iceCheckingTimeout:500\n        });\n\n        webPhone.userAgent.audioHelper.loadAudio({\n            incoming: 'audio/incoming.ogg',\n            outgoing: 'audio/outgoing.ogg'\n        });\n\n        webPhone.userAgent.audioHelper.setVolume(0.3);\n        webPhone.userAgent.on('invite', onInvite);\n        webPhone.userAgent.on('connecting', function() {\n            console.log('UA connecting');\n        });\n        webPhone.userAgent.on('connected', function() {\n            console.log('UA Connected');\n        });\n        webPhone.userAgent.on('disconnected', function() {\n            console.log('UA Disconnected');\n        });\n        webPhone.userAgent.on('registered', function() {\n            console.log('UA Registered');\n        });\n        webPhone.userAgent.on('unregistered', function() {\n            console.log('UA Unregistered');\n        });\n        webPhone.userAgent.on('registrationFailed', function() {\n            console.log('UA RegistrationFailed', arguments);\n        });\n        webPhone.userAgent.on('message', function() {\n            console.log('UA Message', arguments);\n        });\n        webPhone.userAgent.transport.on('switchBackProxy', function() {\n            console.log('switching back to primary outbound proxy');\n            webPhone.userAgent.transport.reconnect(true);\n        });\n        webPhone.userAgent.transport.on('closed', function() {\n            console.log('WebSocket closed.');\n        });\n        webPhone.userAgent.transport.on('transportError', function() {\n            console.log('WebSocket transportError occured');\n        });\n        webPhone.userAgent.transport.on('wsConnectionError', function() {\n            console.log('WebSocket wsConnectionError occured');\n        });\n        return webPhone;\n    }\n\n    function onInvite(session) {\n        outboundCall = false;\n        console.log('EVENT: Invite', session.request);\n        console.log('To', session.request.to.displayName, session.request.to.friendlyName);\n        console.log('From', session.request.from.displayName, session.request.from.friendlyName);\n\n        if (session.request.headers['Alert-Info'] && session.request.headers['Alert-Info'][0].raw === 'Auto Answer') {\n            session\n                .accept()\n                .then(function() {\n                    onAccepted(session);\n                })\n                .catch(function(e) {\n                    console.error('Accept failed', e.stack || e);\n                });\n        } else {\n            var $modal = cloneTemplate($incomingTemplate).modal({\n                backdrop: 'static'\n            });\n\n            $modal.find('.answer').on('click', function() {\n                $modal.find('.before-answer').css('display', 'none');\n                $modal.find('.answered').css('display', '');\n                session\n                    .accept()\n                    .then(function() {\n                        $modal.modal('hide');\n                        onAccepted(session);\n                    })\n                    .catch(function(e) {\n                        console.error('Accept failed', e.stack || e);\n                    });\n            });\n\n            $modal.find('.decline').on('click', function() {\n                session.reject();\n            });\n\n            $modal.find('.toVoicemail').on('click', function() {\n                session.toVoicemail();\n            });\n\n            $modal.find('.forward-form').on('submit', function(e) {\n                e.preventDefault();\n                e.stopPropagation();\n                session\n                    .forward(\n                        $modal\n                            .find('input[name=forward]')\n                            .val()\n                            .trim()\n                    )\n                    .then(function() {\n                        console.log('Forwarded');\n                        $modal.modal('hide');\n                    })\n                    .catch(function(e) {\n                        console.error('Forward failed', e.stack || e);\n                    });\n            });\n\n            $modal.find('.reply-form').on('submit', function(e) {\n                e.preventDefault();\n                e.stopPropagation();\n                session\n                    .replyWithMessage({\n                        replyType: 0,\n                        replyText: $modal.find('input[name=reply]').val()\n                    })\n                    .then(function() {\n                        console.log('Replied');\n                        $modal.modal('hide');\n                    })\n                    .catch(function(e) {\n                        console.error('Reply failed', e.stack || e);\n                    });\n            });\n\n            session.on('rejected', function() {\n                $modal.modal('hide');\n            });\n        }\n    }\n\n    const activeCallInfoTemplate = () => ({\n        id: '',\n        from: '',\n        to: '',\n        direction: '',\n        sipData: {\n            toTag: '',\n            fromTag: ''\n        }\n    });\n\n    function captureActiveCallInfo(session) {\n        const direction = outboundCall ? 'Outbound' : 'Inbound';\n        var activeCallInfo = activeCallInfoTemplate();\n        activeCallInfo.from = session.request.from.uri.user;\n        activeCallInfo.to = session.request.to.uri.user;\n        activeCallInfo.direction = direction;\n        activeCallInfo.id = session.dialog.id.callId;\n        activeCallInfo.sipData.fromTag = session.dialog.id.remoteTag;\n        activeCallInfo.sipData.toTag = session.dialog.id.localTag;\n        if (!localStorage.getItem('activeCallInfo')) {\n            localStorage.setItem('activeCallInfo', JSON.stringify(activeCallInfo));\n        }\n    }\n\n    function onAccepted(session) {\n        console.log('EVENT: Accepted', session.request);\n        console.log('To', session.request.to.displayName, session.request.to.friendlyName);\n        console.log('From', session.request.from.displayName, session.request.from.friendlyName);\n\n        var $modal = cloneTemplate($acceptedTemplate).modal();\n\n        var $info = $modal.find('.info').eq(0);\n        var $dtmf = $modal.find('input[name=dtmf]').eq(0);\n        var $transfer = $modal.find('input[name=transfer]').eq(0);\n        var $flip = $modal.find('input[name=flip]').eq(0);\n        var $conference = $modal.find('input[name=conference]').eq(0);\n\n        var interval = setInterval(function() {\n            var time = session.startTime ? Math.round((Date.now() - session.startTime) / 1000) + 's' : 'Ringing';\n\n            $info.text('time: ' + time + '\\n' + 'startTime: ' + JSON.stringify(session.startTime, null, 2) + '\\n');\n        }, 1000);\n\n        function close() {\n            clearInterval(interval);\n            $modal.modal('hide');\n        }\n\n        $modal.find('.increase-volume').on('click', function() {\n            session.ua.audioHelper.setVolume(\n                (session.ua.audioHelper.volume !== null ? session.ua.audioHelper.volume : 0.5) + 0.1\n            );\n        });\n\n        $modal.find('.decrease-volume').on('click', function() {\n            session.ua.audioHelper.setVolume(\n                (session.ua.audioHelper.volume !== null ? session.ua.audioHelper.volume : 0.5) - 0.1\n            );\n        });\n\n        $modal.find('.mute').on('click', function() {\n            session.mute();\n        });\n\n        $modal.find('.unmute').on('click', function() {\n            session.unmute();\n        });\n\n        $modal.find('.hold').on('click', function() {\n            session\n                .hold()\n                .then(function() {\n                    console.log('Holding');\n                })\n                .catch(function(e) {\n                    console.error('Holding failed', e.stack || e);\n                });\n        });\n\n        $modal.find('.unhold').on('click', function() {\n            session\n                .unhold()\n                .then(function() {\n                    console.log('UnHolding');\n                })\n                .catch(function(e) {\n                    console.error('UnHolding failed', e.stack || e);\n                });\n        });\n        $modal.find('.startRecord').on('click', function() {\n            session\n                .startRecord()\n                .then(function() {\n                    console.log('Recording Started');\n                })\n                .catch(function(e) {\n                    console.error('Recording Start failed', e.stack || e);\n                });\n        });\n\n        $modal.find('.stopRecord').on('click', function() {\n            session\n                .stopRecord()\n                .then(function() {\n                    console.log('Recording Stopped');\n                })\n                .catch(function(e) {\n                    console.error('Recording Stop failed', e.stack || e);\n                });\n        });\n\n        $modal.find('.park').on('click', function() {\n            session\n                .park()\n                .then(function() {\n                    console.log('Parked');\n                })\n                .catch(function(e) {\n                    console.error('Park failed', e.stack || e);\n                });\n        });\n\n        $modal.find('.transfer-form').on('submit', function(e) {\n            e.preventDefault();\n            e.stopPropagation();\n            session\n                .transfer($transfer.val().trim())\n                .then(function() {\n                    console.log('Transferred');\n                })\n                .catch(function(e) {\n                    console.error('Transfer failed', e.stack || e);\n                });\n        });\n\n        $modal.find('.transfer-form button.warm').on('click', function(e) {\n            e.preventDefault();\n            e.stopPropagation();\n            session.hold().then(function() {\n                console.log('Placing the call on hold, initiating attended transfer');\n                var newSession = session.ua.invite($transfer.val().trim());\n                newSession.once('accepted', function() {\n                    console.log('New call initated. Click Complete to complete the transfer');\n                    $modal.find('.transfer-form button.complete').on('click', function(e) {\n                        session\n                            .warmTransfer(newSession)\n                            .then(function() {\n                                console.log('Warm transfer completed');\n                            })\n                            .catch(function(e) {\n                                console.error('Transfer failed', e.stack || e);\n                            });\n                    });\n                });\n            });\n        });\n\n        $modal.find('.flip-form').on('submit', function(e) {\n            e.preventDefault();\n            e.stopPropagation();\n            session\n                .flip($flip.val().trim())\n                .then(function() {\n                    console.log('Flipped');\n                })\n                .catch(function(e) {\n                    console.error('Flip failed', e.stack || e);\n                });\n            $flip.val('');\n        });\n\n        $modal.find('.dtmf-form').on('submit', function(e) {\n            e.preventDefault();\n            e.stopPropagation();\n            session.dtmf($dtmf.val().trim());\n            $dtmf.val('');\n        });\n\n        var $startConfButton = $modal.find('.startConf');\n\n        $startConfButton.on('click', function(e) {\n            initConference();\n        });\n\n        $modal.find('.hangup').on('click', function() {\n            session.terminate();\n        });\n\n        session.on('accepted', function() {\n            console.log('Event: Accepted');\n            captureActiveCallInfo(session);\n        });\n        session.on('progress', function() {\n            console.log('Event: Progress');\n        });\n        session.on('rejected', function() {\n            console.log('Event: Rejected');\n            close();\n        });\n        session.on('failed', function() {\n            console.log('Event: Failed', arguments);\n            close();\n        });\n        session.on('terminated', function() {\n            console.log('Event: Terminated');\n            localStorage.setItem('activeCallInfo', '');\n            close();\n        });\n        session.on('cancel', function() {\n            console.log('Event: Cancel');\n            close();\n        });\n        session.on('refer', function() {\n            console.log('Event: Refer');\n            close();\n        });\n        session.on('replaced', function(newSession) {\n            console.log('Event: Replaced: old session', session, 'has been replaced with', newSession);\n            close();\n            onAccepted(newSession);\n        });\n        session.on('dtmf', function() {\n            console.log('Event: DTMF');\n        });\n        session.on('muted', function() {\n            console.log('Event: Muted');\n        });\n        session.on('unmuted', function() {\n            console.log('Event: Unmuted');\n        });\n        session.on('connecting', function() {\n            console.log('Event: Connecting');\n        });\n        session.on('bye', function() {\n            console.log('Event: Bye');\n            close();\n        });\n    }\n\n    function makeCall(number, homeCountryId) {\n        outboundCall = true;\n        homeCountryId =\n            homeCountryId ||\n            (extension &&\n                extension.regionalSettings &&\n                extension.regionalSettings.homeCountry &&\n                extension.regionalSettings.homeCountry.id) ||\n            null;\n\n        var session = webPhone.userAgent.invite(number, {\n            fromNumber: username,\n            homeCountryId\n        });\n\n        onAccepted(session);\n    }\n\n    function switchCall() {\n        var activeCallItem = JSON.parse(localStorage.getItem('activeCallInfo'));\n        console.log('Switching active call to current tab: ', activeCallItem);\n        var session = webPhone.userAgent.switchFrom(activeCallItem);\n        onAccepted(session);\n    }\n\n    var onConference = false;\n\n    function initConference() {\n        if (!onConference) {\n            getPresenceActiveCalls().then(res => {\n                var response = res.json();\n                var pId = response.activeCalls[0].partyId;\n                var tId = response.activeCalls[0].telephonySessionId;\n                getConfVoiceToken(pId, tId).then(voiceToken => {\n                    startConferenceCall(voiceToken, pId, tId);\n                    onConference = true;\n                });\n            });\n        }\n    }\n\n    function getPresenceActiveCalls() {\n        return platform.get('/restapi/v1.0/account/~/extension/~/presence?detailedTelephonyState=true');\n    }\n\n    function getConfVoiceToken(pId, tId) {\n        return platform.post('/restapi/v1.0/account/~/telephony/conference', {}).then(res => {\n            confSessionId = res.json().session.id;\n            return res.json().session.voiceCallToken;\n        });\n    }\n\n    function startConferenceCall(number, pId, tId) {\n        var session = webPhone.userAgent.invite(number, {\n            fromNumber: username\n        });\n        session.on('accepted', function() {\n            onAccepted(session);\n            console.log('Conference call started');\n            bringIn(tId, pId)\n                .then(response => {\n                    console.log('Adding call to conference succesful', response.json());\n                })\n                .catch(function(e) {\n                    console.error('Conference call failed', e.stack || e);\n                });\n        });\n    }\n\n    function bringIn(tId, pId) {\n        var url = '/restapi/v1.0/account/accountId/telephony/sessions/' + confSessionId + '/parties/bring-in';\n        return platform.post(url, {\n            telephonySessionId: tId,\n            partyId: pId\n        });\n    }\n\n    function makeCallForm() {\n        var $form = cloneTemplate($callTemplate);\n\n        var $number = $form.find('input[name=number]').eq(0);\n        var $homeCountry = $form.find('input[name=homeCountry]').eq(0);\n        var $username = $form.find('.username').eq(0);\n        var $logout = $form.find('.logout').eq(0);\n        var $switch = $form.find('.switch').eq(0);\n\n        $username.html(\n            '<dl>' +\n                '<dt>Contact</dt><dd>' +\n                extension.contact.firstName +\n                ' ' +\n                extension.contact.lastName +\n                '</dd>' +\n                '<dt>Company</dt><dd>' +\n                (extension.contact.company || '?') +\n                '</dd>' +\n                '<dt>Phone Number</dt><dd>' +\n                username +\n                '</dd>' +\n                '</dl>'\n        );\n\n        $logout.on('click', function(e) {\n            webPhone.userAgent.unregister();\n            e.preventDefault();\n            location.reload();\n        });\n\n        $switch.on('click', function(e) {\n            switchCall();\n        });\n\n        $number.val(localStorage.getItem('webPhoneLastNumber') || '');\n\n        $form.on('submit', function(e) {\n            e.preventDefault();\n            e.stopPropagation();\n\n            localStorage.setItem('webPhoneLastNumber', $number.val() || '');\n\n            makeCall($number.val(), $homeCountry.val());\n        });\n\n        $app.empty().append($form);\n    }\n\n    function makeLoginForm() {\n        var $form = cloneTemplate($loginTemplate);\n        var $authForm = cloneTemplate($authFlowTemplate);\n\n        var $server = $authForm.find('input[name=server]').eq(0);\n        var $appKey = $authForm.find('input[name=appKey]').eq(0);\n        var $appSecret = $authForm.find('input[name=appSecret]').eq(0);\n        var $login = $form.find('input[name=login]').eq(0);\n        var $ext = $form.find('input[name=extension]').eq(0);\n        var $password = $form.find('input[name=password]').eq(0);\n        var $logLevel = $authForm.find('select[name=logLevel]').eq(0);\n\n        $server.val(localStorage.getItem('webPhoneServer') || SDK.server.sandbox);\n        $appKey.val(localStorage.getItem('webPhoneAppKey') || '');\n        $appSecret.val(localStorage.getItem('webPhoneAppSecret') || '');\n        $login.val(localStorage.getItem('webPhoneLogin') || '');\n        $ext.val(localStorage.getItem('webPhoneExtension') || '');\n        $password.val(localStorage.getItem('webPhonePassword') || '');\n        $logLevel.val(localStorage.getItem('webPhoneLogLevel') || logLevel);\n\n        $form.on('submit', function(e) {\n            console.log('Normal Flow');\n\n            e.preventDefault();\n            e.stopPropagation();\n\n            login(\n                $server.val(),\n                $appKey.val(),\n                $appSecret.val(),\n                $login.val(),\n                $ext.val(),\n                $password.val(),\n                $logLevel.val()\n            );\n        });\n        //\n        $authForm.on('submit', function(e) {\n            console.log('Authorized Flow');\n\n            e.preventDefault();\n            e.stopPropagation();\n\n            show3LeggedLogin($server.val(), $appKey.val(), $appSecret.val(), $logLevel.val());\n        });\n\n        $app.empty()\n            .append($authForm)\n            .append($form);\n    }\n\n    makeLoginForm();\n});\n","module.exports = undefined;"],"sourceRoot":""}